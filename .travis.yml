cache: apt
language: cpp
compiler:
  - gcc
env:
  - OMP_NUM_THREADS=2

before_install:
  - cd $TRAVIS_BUILD_DIR/install/savu_hpc/savu_installer
  - ls -lah
  - touch ~/.condarc
  - "echo channel_priority: strict >> ~/.condarc"

install:
  - PREFIX=/tmp bash savu_installer.sh --local --no_prompts

script:
  - source /tmp/miniconda/bin/activate /tmp/savu
  - pip install coverage pytest-cov
  - cd $TRAVIS_BUILD_DIR
  - pytest scripts/configurator_tests/ --cov=scripts
  - pytest savu/test/travis --cov=savu --cov-report term-missing
  - python -c "import savu; savu.run_tests()"
  - python -c "import savu; savu.run_full_tests()"
